---
title: 2016-by-wkwkrnht更新のお知らせ
author: wkwkrnht
type: post
date: 2016-10-01T08:36:35+00:00
url: /sitemanagement/wordpress/theme/511/
snap_MYURL:
  - 
  - 
snapEdIT:
  - 1
  - 1
snapFB:
  - 
  - 
snapTW:
  - 
  - 
snapWP:
  - 's:212:"a:1:{i:0;a:6:{s:2:"do";s:1:"1";s:11:"SNAPformatT";s:15:"%TITLE% %HTAGS%";s:10:"SNAPformat";s:46:"<a class="embedly-card" href="%URL%">%URL%</a>";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:4:"doWP";s:1:"1";}}";'
  - 's:212:"a:1:{i:0;a:6:{s:2:"do";s:1:"1";s:11:"SNAPformatT";s:15:"%TITLE% %HTAGS%";s:10:"SNAPformat";s:46:"<a class="embedly-card" href="%URL%">%URL%</a>";s:9:"isAutoImg";s:1:"A";s:8:"imgToUse";s:0:"";s:4:"doWP";s:1:"1";}}";'

---
  * 構造化マークアップを追加
  * WPHeader
  * WPAdblock
  * SiteNavigationElements
  * SearchResulghts

  * Google Adsense周りも充実(ウィジェットやらショートコードやらいろいろ追加)
  * ウィジェット設定の消滅と今までの設定をウィジェットごとに行うように変更
  * カスタムヘッダー機能に対応
  * 見出し周りのCSS修正
  * 色選択可能範囲拡大
  * 純正ショートコードとspotify埋め込のクイックタグも増設
  * amp.phpの仕様変更
  * role=&#8221;searc﻿h﻿&#8221;追加
  * tabindex=&#8221;0&#8243;追加
  * role=&#8221;button&#8221;追加
  * TinyMCEにボタン追加
  * CSSのブレイクポイントが992pxと640pxの2つに変わりました
  * 自動生成される画像を増やしました(レスポンシブイメージ対応のためです)
  * singular.phpとindex.phpを結合しました
  * special-card.phpもindex.phpに結合しました
  * special-cardの一般形でサイトの概要を表示しないように
  * カスタマイザーを読み込めなかった不具合を解消
  * メインメニューと共有メニューへの動線の変化
  * 始めの「＋」ボタンでメニューウィンドウが出るように
  * メニューウィンドウ内のタブでメインメニューと共有メニューの切り替えを行うように

  * Instapaperとvkとstumbleuponとbufferへの共有に対応
  * olタグに装飾追加
  * <a href="https://q-az.net/wordpress-nyoki-nav/" title="参考記事" target="_blank" rel="noopener">ホバーで出てくる前後ナビゲーションウィジェットの追加</a>
  * ナイトモードのバグ修正
  * Live Dwango Readerのソーシャルメニュー内装飾対応
  * target=&#8221;_blank&#8221;とtitle属性を自動付与するショートコード[link]を追加

## 目次機能を付けました

データベース系の記事が増えてきたので、目次がほしいなぁと思っていたところ。<a href="https://xakuro.com/blog/wordpress/277" target="_blank" rel="noopener">こんな記事</a>を見つけたので移植しました。利用する際は、id=の部分にid属性に適当な文字列を入れるか、消すかしてください。まだ、ジャンプ機能は実装できていません。

## 開発体制の変化

それとは前後しますが、Githubのレポジトリがmaterブランチとdevブランチのトロイカになりました。今まで、アップデート作業は自動化できていませんでしたが、<a href="http://wkwkrnht.gegahost.net/sitemanagement/wordpress/piugin/183" target="_blank" rel="noopener">WP Puaher</a>との併用でmasterブランチから安定板が自動アップデートできるようになりました。ちなみに、devブランチは、こちらが使っている文字通りの開発版です。プルリクはそちらにお願いします。

## 思いがけない表示崩れ

<blockquote class="twitter-tweet" data-lang="ja" data-align="center">
  <p lang="ja" dir="ltr">
    一部ページに表示崩れが起きております。原因と思しきものは見えましたので明日どうにかします。
  </p>
  
  <p>
    &mdash; wkwkrnht (<a href="http://twitter.com/wkwkrnht" target="_blank" rel="noopener nofollow">@wkwkrnht</a>) <a href="https://twitter.com/wkwkrnht/status/781867596136128512">2016年9月30日</a>
  </p>
</blockquote>



というわけでどうにかしました。どういうことが起きていたかというと、少なくとも<a href="http://wkwkrnht.gegahost.net/delusion/472" target="_blank" rel="noopener">こちらのページ</a>で三つ目のブログカード以降が重なって表示されるというものです。原因は、概要の中にHTMLタグが閉じタグなしで紛れ込んだことによるものでした。これを表示するために、使っているライブラリが、そこまで想定してなかったのでしょう。OGPの中で、概要があったらそれを、そうじゃなかったら概要タグから拾う。その程度の対応でしたし。(まあ、UTF-8対応すらされてないのでお察しですが)そんなわけで、キャッシュの値を直接いじることで解消しました。仕組みとしては、<a href="http://nelog.jp/wordpress-transient" target="_blank" rel="noopener">こちら</a>ですので。同様の現象にお会いの方は、データベース内の値をいじってください。site_transit+URLな形で名付けてありますから。おおもとの仕組みにしても、<a href="https://wp-simplicity.com/suport/topic/%e5%a4%96%e9%83%a8%e3%82%b5%e3%82%a4%e3%83%88%e3%81%aeogp%e3%81%8b%e3%82%89blogcard%e3%82%92%e4%bd%9c%e3%82%8b/" target="_blank" rel="noopener">こちら</a>ですからSimplicityの劣化版に近いと思います。共有機能は独自のものですが。

## ナイトモードのバグ修正

実はですね。Google Cookie Choices対応のため、スクリプトを追加したところ動かなくなってしまいました。今のところコメントアウトで対応しています。<a href="https://q-az.net/wordpress-night-mode/" target="_blank" rel="noopener">ナイトモードの仕組みはこちら。</a><a href="https://q-az.net/css-in-single-post/" target="_blank" rel="noopener">こちら</a>も元々実装していました。なぜ今のタイミングでの高評価というと、<a href="https://twitter.com/gzzdino/status/779461749636337664" target="_blank" rel="noopener">作者様の意向</a>です。

## まとめ

詳細は、コミットログを見てください。

<div class="ogp-blogcard">
  <div id="ogp-blogcard-share-https://github.com/wkwkrnht/2016-by-wkwkrnht" class="ogp-blogcard-share none">
    <a href="javascript:void(0)" class="ogp-blogcard-share-close" tabindex="0" onclick="document.getElementById('ogp-blogcard-share-https://github.com/wkwkrnht/2016-by-wkwkrnht').classList.toggle('none');document.getElementById('ogp-blogcard-share-https://github.com/wkwkrnht/2016-by-wkwkrnht').classList.toggle('block');">×</a> 
    
    <ul>
      <li>
        <a href="https://twitter.com/share?url=https%3A%2F%2Fgithub.com%2Fwkwkrnht%2F2016-by-wkwkrnht&text=wkwkrnht/2016-by-wkwkrnht" target="_blank" rel="noopener" tabindex="0"><i class="fa fa-twitter" aria-hidden="true"></i></a>
      </li>
      <li>
        <a href="http://www.facebook.com/share.php?u=https%3A%2F%2Fgithub.com%2Fwkwkrnht%2F2016-by-wkwkrnht" target="_blank" rel="noopener" tabindex="0"><i class="fa fa-thumbs-up" aria-hidden="true"></i></a>
      </li>
      <li>
        <a href="http://getpocket.com/edit?url=https%3A%2F%2Fgithub.com%2Fwkwkrnht%2F2016-by-wkwkrnht&title=wkwkrnht/2016-by-wkwkrnht" target="_blank" rel="noopener" tabindex="0"><i class="fa fa-get-pocket" aria-hidden="true"></i></a>
      </li>
      <li>
        <a href="http://b.hatena.ne.jp/add?mode=confirm&url=https%3A%2F%2Fgithub.com%2Fwkwkrnht%2F2016-by-wkwkrnht&title=wkwkrnht/2016-by-wkwkrnht" target="_blank" rel="noopener" tabindex="0">B!</a>
      </li>
    </ul>
  </div>
  
  <blockquote class="ogp-blogcard-main" cite="https://github.com/wkwkrnht/2016-by-wkwkrnht">
    <img class="ogp-blogcard-img" src="https://avatars2.githubusercontent.com/u/16859247?v=3&s=400" /> <a href="https://github.com/wkwkrnht/2016-by-wkwkrnht" target="_blank" rel="noopener" tabindex="0" title="wkwkrnht/2016-by-wkwkrnht" class="ogp-blogcard-info"> 
    
    <h2 class="ogp-blogcard-title">
      wkwkrnht/2016-by-wkwkrnht
    </h2>
    
    <p class="ogp-blogcard-description">
      2016-by-wkwkrnht - Wordpress テーマ
    </p></a>
  </blockquote>
  
  <a href="javascript:void(0)" class="ogp-blogcard-share-toggle" tabindex="0" onclick="document.getElementById('ogp-blogcard-share-https://github.com/wkwkrnht/2016-by-wkwkrnht').classList.toggle('none');document.getElementById('ogp-blogcard-share-https://github.com/wkwkrnht/2016-by-wkwkrnht').classList.toggle('block');"><i class="fa fa-2x fa-share-alt"></i></a>
</div>

ちょっと前に、<a href="http://wkwkrnht.gegahost.net/sitemanagement/wordpress/piugin/556" target="_blank" rel="noopener">記事に書いた通り</a>なのですけれども。gegahost.netのセキュリティ意識の高さにやられて、dlver.itすらも連携できていない状況です。何とか、これを打破したいところでございますが、それは、このwordpress上で同等のものを動かすしかありません。それについては追々報告したいと思います。まったく、それを除けば懐が深すぎるいいサービスなんですけどね。